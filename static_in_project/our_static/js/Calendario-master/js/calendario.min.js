+function(t){"use strict";function e(e,n,o,s){var i="";return this.each(function(){var r=t(this),h=r.data("bz.calendario"),p="object"==typeof e&&e;return h||r.data("bz.calendario",h=new a(this,p)),"string"==typeof e&&t.isFunction(h[e])?i=h[e](n,o,s):"string"==typeof e?i=h.option(n,o):void 0}),i?i:void t(document).trigger(t.Event("finish.calendar.calendario"))}var a=function(t,e){this.init("calendario",t,e)};a.INFO={EMAIL:"%email%",FEED:"%feed%",NAME:"HangingTime!",VERSION:"5.0.1",UNIQUE:"%unique%",USER:"%user%",UPDATEURL:"%url%"},a.DEFAULTS={weeks:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekabbrs:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthabbrs:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],displayWeekAbbr:!1,displayMonthAbbr:!1,startIn:1,fillEmpty:!0,zone:"00:00",events:["click","focus"],checkUpdate:!0,weekdays:"MON, TUE, WED, THU, FRI",weekends:"SAT, SUN",format:"MM-DD-YYYY",feed:"http://calendario.t15.org/sync/"},a.prototype.init=function(e,n,o){this.INFO=a.INFO,this.type=e,this.$element=t(n),this.options=t.extend({},a.DEFAULTS,this.$element.data(),o),this.today=new Date,this.month=isNaN(this.options.month)||null===this.options.month?this.today.getMonth():this.options.month-1,this.year=isNaN(this.options.year)||null===this.options.year?this.today.getFullYear():this.options.year,this.caldata=this.processCaldata(this.options.caldata),this.curData=[],this.syncData={},this.generateTemplate(),this.initEvents()},a.prototype.sync=function(e){var a=this;return t.post(a.options.feed,{info:a.INFO,caldata:e,domain:document.domain},function(t){a.syncData=t},"json"),e},a.prototype.initEvents=function(){this.$element.on(this.options.events.join(".calendario ").trim()+".calendario","div.fc-row > div:not(:empty)",function(e){t(this).trigger(t.Event("onDay"+e.type.charAt(0).toUpperCase()+e.type.slice(1)),[t(this).data("bz.calendario.dateprop")])})},a.prototype.propDate=function(){var e,a,n,o,s,i,r=this;this.$element.find("div.fc-row > div").filter(":not(:empty)").each(function(){o=t(this).children("span.fc-date").hasClass("fc-emptydate"),n=t(this).children("span.fc-date").text(),e=o&&n<=31&&n>=24?r.month-1:o&&n>=1&&n<=7?r.month+1:r.month,a=12==e?r.year+1:e==-1?r.year-1:r.year,e=12==e?0:e==-1?11:e,s=!!r.curData[n]&&r.curData[n],s?(i={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[]},t.each(s.startTime,function(t,o){o.getDate()==n&&o.getMonth()==e&&o.getFullYear()==a&&(i.startTime.push(o),i.endTime.push(s.endTime[t]),i.allDay.push(s.allDay[t]),i.html.push(s.html[t]),i.note.push(s.note[t]),i.content.push(s.content[t]),i.url.push(s.url[t]))}),0==i.html.length&&(i=!1)):i=!1;var h={day:t(this).children("span.fc-date").text(),month:e+1,monthname:r.options.displayMonthAbbr?r.options.monthabbrs[e]:r.options.months[e],year:a,weekday:t(this).index()+r.options.startIn,weekdayname:r.options.weeks[6==t(this).index()?0:t(this).index()+r.options.startIn],data:i};t(this).data("bz.calendario.dateprop",h)})},a.prototype.insertToCaldata=function(t,e,a,n,o){return n[t]||(n[t]=[]),e.repeat?e.day=[a[o.DD],e.endDate.split("-")[o.DD]]:e.day=[a[o.DD],a[o.DD]],e.repeat?e.month=[a[o.MM],e.endDate.split("-")[o.MM]]:e.month=[a[o.MM],a[o.MM]],e.repeat?e.year=[a[o.YYYY],e.endDate.split("-")[o.YYYY]]:e.year=[a[o.YYYY],a[o.YYYY]],e.category=e.category?"calendar-"+e.category.split("-").pop():"calendar-default",n[t].push(e)?n:n},a.prototype.processCaldata=function(e){var a={},n=this,o={};return t.each(this.options.format.toUpperCase().split("-"),function(t,e){o[e]=t}),t.each(e,function(e,s){t.each(s,function(s,i){"INTERVAL"==i.repeat||"EVERYDAY"==i.repeat?i.repeat="MON, TUE, WED, THU, FRI, SAT, SUN":"WEEKDAYS"==i.repeat?i.repeat=n.options.weekdays:"WEEKENDS"==i.repeat&&(i.repeat=n.options.weekends),t.inArray(i.repeat,[void 0,"YEARLY","MONTHLY"])!=-1?a=n.insertToCaldata(parseInt(e.split("-")[o.DD]),i,e.split("-"),a,o):i.repeat&&t.each(i.repeat.split(","),function(s,r){a=n.insertToCaldata(r.trim(),t.extend(i,{repeat:"WEEKLY"}),e.split("-"),a,o)})})}),n.sync(a)},a.prototype.toDObj=function(t,e){var a=parseInt(this.options.zone.split(":")[0]),n=parseInt(this.options.zone.charAt(0)+this.options.zone.split(":")[1]),o=parseInt(t.split(":")[0])-a,s=parseInt(t.split(":")[1])-n;return new Date(Date.UTC(this.year,this.month,e,o,s,0,0))},a.prototype.parseDay=function(t,e){this.curData[e]||(this.curData[e]={html:[],allDay:[],startTime:[],endTime:[],note:[],content:[],url:[]}),t.allDay?this.curData[e].allDay.push(!0):this.curData[e].allDay.push(!1),t.allDay?this.curData[e].startTime.push(this.toDObj("00:00",e)):this.curData[e].startTime.push(this.toDObj(t.startTime,e)),t.allDay?this.curData[e].endTime.push(this.toDObj("23:59",e)):this.curData[e].endTime.push(this.toDObj(t.endTime,e)),t.note?this.curData[e].note.push(t.note):this.curData[e].note.push(""),t.content?this.curData[e].content.push(t.content):this.curData[e].content.push(""),t.url?this.curData[e].url.push(t.url):this.curData[e].url.push("");var a=t.url?this.curData[e].html.push('<a class="'+t.category+'" href="'+t.url+'">'+t.content+"</a>")-1:this.curData[e].html.push('<span class="'+t.category+'">'+t.content+"</span>")-1;this.curData[e].html[a]+='<time class="fc-allday" datetime="'+this.curData[e].allDay[a]+'"></time>',this.curData[e].html[a]+='<time class="fc-starttime" datetime="'+this.curData[e].startTime[a].toISOString()+'"></time>',this.curData[e].html[a]+='<time class="fc-endtime" datetime="'+this.curData[e].endTime[a].toISOString()+'"></time>',this.curData[e].html[a]+="<note>"+this.curData[e].note[a]+"</note>",this.isProperlyParsed=!0},a.prototype.parseDataToDay=function(e,a,n){var o=t.extend({},this,n);return o.isProperlyParsed=!1,t.each(e,function(t,e){e&&("YEARLY"==e.repeat||"MONTHLY"==e.repeat||"WEEKLY"==e.repeat?o.year>=e.year[0]&&o.year<=e.year[1]&&("YEARLY"==e.repeat&&o.month+1==e.month[0]&&o.parseDay(e,a),o.year==e.year[0]&&o.month+1>=e.month[0]?("MONTHLY"==e.repeat&&o.parseDay(e,a),"WEEKLY"==e.repeat&&(e.month[0]+e.year[0]==e.month[1]+e.year[1]?e.month[0]==o.month+1&&e.day[1]>=a&&a>=e.day[0]&&o.parseDay(e,a):e.month[0]==o.month+1&&a>=e.day[0]?o.parseDay(e,a):e.year[0]==e.year[1]&&e.month[1]>o.month+1&&e.month[0]<o.month+1?o.parseDay(e,a):e.year[0]==e.year[1]&&e.month[1]==o.month+1&&a<=e.day[1]?o.parseDay(e,a):e.year[0]!=e.year[1]&&e.month[0]<o.month+1&&o.parseDay(e,a))):e.year[0]<o.year&&o.year<e.year[1]?"MONTHLY"!=e.repeat&&"WEEKLY"!=e.repeat||o.parseDay(e,a):o.month+1<=e.month[1]&&o.year==e.year[1]&&("MONTHLY"==e.repeat&&o.parseDay(e,a),"WEEKLY"==e.repeat&&a<=e.day[1]&&o.month+1==e.month[1]?o.parseDay(e,a):"WEEKLY"==e.repeat&&e.year[0]!=e.year[1]&&o.month+1<e.month[1]&&o.parseDay(e,a))):o.year==e.year[0]&&o.month+1==e.month[0]&&o.parseDay(e,a))}),this.curData[a]&&o.isProperlyParsed?'<div class="fc-calendar-event">'+this.curData[a].html.join('</div><div class="fc-calendar-event">')+"</div>":""},a.prototype.generateTemplate=function(e){this.curData=[];var a=this.getHead(),n=this.getBody(),o="";return 4==this.rowTotal?o="fc-four-rows":5==this.rowTotal?o="fc-five-rows":6==this.rowTotal&&(o="fc-six-rows"),this.$cal=t('<div class="fc-calendar '+o+'">').append(a,n),this.$element.find("div.fc-calendar").remove().end().append(this.$cal),this.propDate(),this.$element.trigger(t.Event("shown.calendar.calendario")),e&&e.call(),!0},a.prototype.getHead=function(){for(var t,e,a='<div class="fc-head">',n=0;n<=6;n++)t=n+this.options.startIn,e=t>6?t-6-1:t,a+="<div>"+(this.options.displayWeekAbbr?this.options.weekabbrs[e]:this.options.weeks[e])+"</div>";return a+"</div>"},a.prototype.getBody=function(){for(var t=new Date(this.year,this.month+1,0),e=t.getDate(),a=new Date(this.year,t.getMonth(),1),n=new Date(this.year,this.month,0).getDate(),o='<div class="fc-body"><div class="fc-row">',s=1,i=1,r=1,h=1,p=a.getDay(),c=0,y=0,l="",d=!1,u=!1,m=!1,f=!0,D="",v=0,g="",T={},Y="",b=0;b<7;b++){for(var E=0;E<=6;E++)c=p-this.options.startIn,y=c<0?6+c+1:c,l="",d=this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&s===this.today.getDate(),u=this.year<this.today.getFullYear()||this.month<this.today.getMonth()&&this.year===this.today.getFullYear()||this.month===this.today.getMonth()&&this.year===this.today.getFullYear()&&s<this.today.getDate(),m=s-e>0,f=E<y&&0===b,D="",v=E+this.options.startIn>6?E+this.options.startIn-6-1:E+this.options.startIn,T={},this.options.fillEmpty&&(E<y||b>0)&&(s>e?(h=s++-e,r=this.month+1==12?this.year+1:this.year,i=this.month+1==12?0:this.month+1):1==s&&(h=n++-y+1,r=this.month-1==-1?this.year-1:this.year,i=this.month-1==-1?11:this.month-1),(s>e||1==s)&&(d=i===this.today.getMonth()&&r===this.today.getFullYear()&&h===this.today.getDate(),u=r<this.today.getFullYear()||i<this.today.getMonth()&&r===this.today.getFullYear()||i===this.today.getMonth()&&r===this.today.getFullYear()&&h<this.today.getDate(),T={month:i,year:r},l='<span class="fc-date fc-emptydate">'+h+'</span><span class="fc-weekday">'+this.options.weekabbrs[v]+"</span>",g=Array.prototype.concat(this.caldata[h],this.caldata[this.options.weekabbrs[v].toUpperCase()]).sort(function(t,e){return(t.allDay?"00:00":t.startTime).replace(":","")-(e.allDay?"00:00":e.startTime).replace(":","")}),g&&(D+=this.parseDataToDay(g,h,T)),""!==D&&(l+='<div class="fc-calendar-events">'+D+"</div>"))),s<=e&&(b>0||E>=y)&&(l='<span class="fc-date">'+s+'</span><span class="fc-weekday">'+this.options.weekabbrs[v]+"</span>",g=Array.prototype.concat(this.caldata[s],this.caldata[this.options.weekabbrs[v].toUpperCase()]).sort(function(t,e){return(t.allDay?"00:00":t.startTime).replace(":","")-(e.allDay?"00:00":e.startTime).replace(":","")}),g&&(D+=this.parseDataToDay(g,s,T)),""!==D&&(l+='<div class="fc-calendar-events">'+D+"</div>"),++s),Y=(d?"fc-today ":u?"fc-past ":"fc-future ")+(f?"fc-previous-month ":"")+(m?"fc-next-month ":"")+(""!==D?"fc-content":""),o+=(""!==Y?'<div class="'+Y.trim()+'">':"<div>")+l+"</div>";if(s>e){this.rowTotal=b+1;break}o+='</div><div class="fc-row">'}return o+"</div></div>"},a.prototype.move=function(t,e,a){return"previous"===e?"month"===t?(this.year=this.month>0?this.year:--this.year,this.month=this.month>0?--this.month:11):"year"===t&&(this.year=--this.year):"next"===e&&("month"===t?(this.year=this.month<11?this.year:++this.year,this.month=this.month<11?++this.month:0):"year"===t&&(this.year=++this.year)),this.generateTemplate(a)},a.prototype.option=function(t,e){return e?this.options[t]=e:this.options[t]},a.prototype.getYear=function(){return this.year},a.prototype.getMonth=function(){return this.month+1},a.prototype.getMonthName=function(){return this.options.displayMonthAbbr?this.options.monthabbrs[this.month]:this.options.months[this.month]},a.prototype.getCell=function(e,a){return a?this.$cal.find("span.fc-date").filter(function(){return t(this).text()==e}).parent().data("bz.calendario.dateprop"):this.$cal.find("span.fc-date").filter(function(){return t(this).text()==e}).parent()},a.prototype.setData=function(e,a){return a?this.caldata=this.processCaldata(e):t.extend(this.caldata,this.processCaldata(e)),this.generateTemplate()},a.prototype.gotoNow=function(t){return this.month=this.today.getMonth(),this.year=this.today.getFullYear(),this.generateTemplate(t)},a.prototype.gotoMonth=function(t,e,a){return this.month=t-1,this.year=e,this.generateTemplate(a)},a.prototype.gotoPreviousMonth=function(t){return this.move("month","previous",t)},a.prototype.gotoPreviousYear=function(t){return this.move("year","previous",t)},a.prototype.gotoNextMonth=function(t){return this.move("month","next",t)},a.prototype.gotoNextYear=function(t){return this.move("year","next",t)},a.prototype.feed=function(){return this.syncData.feed?this.syncData.feed:"not-available"},a.prototype.version=function(){return this.INFO.VERSION};var n=t.fn.calendario;t.fn.calendario=e,t.fn.calendario.Constructor=a,t.fn.calendario.noConflict=function(){return t.fn.calendario=n,this}}(jQuery);